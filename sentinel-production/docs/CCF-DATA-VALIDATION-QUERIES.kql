// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CCF DATA VALIDATION QUERIES
// Purpose: Distinguish NEW CCF data from OLD Logic App data
// Deployment Time: 2025-11-12 21:32:10 (UTC-5)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// BASELINE: Check what data exists BEFORE CCF deployment
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 1. OLD TacitRed Data (Before CCF)
TacitRed_Findings_CL
| where TimeGenerated < datetime(2025-11-12 21:32:10)  // BEFORE deployment
| summarize 
    OldDataCount = count(),
    OldestRecord = min(TimeGenerated),
    NewestRecord = max(TimeGenerated),
    UniqueEmails = dcount(email_s)
| extend DataSource = "OLD (Logic Apps or Previous CCF)"

// 2. OLD Cyren Data (Before CCF)
Cyren_Indicators_CL
| where TimeGenerated < datetime(2025-11-12 21:32:10)  // BEFORE deployment
| summarize 
    OldDataCount = count(),
    OldestRecord = min(TimeGenerated),
    NewestRecord = max(TimeGenerated),
    UniqueIndicators = dcount(coalesce(ip_s, url_s, fileHash_s))
| extend DataSource = "OLD (Logic Apps or Previous CCF)"

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// NEW DATA: Track CCF ingestion (AFTER deployment)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 3. NEW TacitRed Data (From CCF)
TacitRed_Findings_CL
| where TimeGenerated >= datetime(2025-11-12 21:32:10)  // AFTER CCF deployment
| summarize 
    NewDataCount = count(),
    FirstIngestion = min(TimeGenerated),
    LatestIngestion = max(TimeGenerated),
    UniqueEmails = dcount(email_s),
    SampleEmails = make_set(email_s, 5)
| extend 
    DataSource = "NEW (CCF)",
    MinutesSinceDeployment = datetime_diff('minute', now(), datetime(2025-11-12 21:32:10))

// 4. NEW Cyren Data (From CCF)
Cyren_Indicators_CL
| where TimeGenerated >= datetime(2025-11-12 21:32:10)  // AFTER CCF deployment
| summarize 
    NewDataCount = count(),
    FirstIngestion = min(TimeGenerated),
    LatestIngestion = max(TimeGenerated),
    ByCategory = count() by category_s,
    SampleIPs = make_set(ip_s, 5)
| extend 
    DataSource = "NEW (CCF)",
    MinutesSinceDeployment = datetime_diff('minute', now(), datetime(2025-11-12 21:32:10))

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// COMPARISON: Old vs New Data
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 5. TacitRed: OLD vs NEW
TacitRed_Findings_CL
| extend DataPeriod = iff(TimeGenerated >= datetime(2025-11-12 21:32:10), "NEW (CCF)", "OLD (Previous)")
| summarize 
    Count = count(),
    Earliest = min(TimeGenerated),
    Latest = max(TimeGenerated)
    by DataPeriod
| project DataPeriod, Count, Earliest, Latest

// 6. Cyren: OLD vs NEW  
Cyren_Indicators_CL
| extend DataPeriod = iff(TimeGenerated >= datetime(2025-11-12 21:32:10), "NEW (CCF)", "OLD (Previous)")
| summarize 
    Count = count(),
    Earliest = min(TimeGenerated),
    Latest = max(TimeGenerated)
    by DataPeriod
| project DataPeriod, Count, Earliest, Latest

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// REAL-TIME MONITORING: Check for continuous ingestion
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 7. TacitRed: Last Hour Activity
TacitRed_Findings_CL
| where TimeGenerated > ago(1h)
| summarize 
    EventsLastHour = count(),
    LatestEvent = max(TimeGenerated)
| extend 
    MinutesAgo = datetime_diff('minute', now(), LatestEvent),
    Status = iff(MinutesAgo <= 60, "âœ… Active", "âš ï¸ No recent data")

// 8. Cyren: Last Hour Activity
Cyren_Indicators_CL
| where TimeGenerated > ago(1h)
| summarize 
    EventsLastHour = count(),
    LatestEvent = max(TimeGenerated)
| extend 
    MinutesAgo = datetime_diff('minute', now(), LatestEvent),
    Status = iff(MinutesAgo <= 60, "âœ… Active", "âš ï¸ No recent data")

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DETAILED: NEW Data Breakdown (First 24 Hours)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 9. TacitRed NEW Data: Detailed View
TacitRed_Findings_CL
| where TimeGenerated >= datetime(2025-11-12 21:32:10)
| where TimeGenerated <= datetime_add('hour', 24, datetime(2025-11-12 21:32:10))
| extend HourBucket = bin(TimeGenerated, 1h)
| summarize 
    EventCount = count(),
    UniqueEmails = dcount(email_s),
    SampleFindings = take_any(findingType_s, 3)
    by HourBucket
| order by HourBucket asc
| project 
    Hour = HourBucket,
    Events = EventCount,
    UniqueEmails,
    SampleFindings

// 10. Cyren NEW Data: Detailed View
Cyren_Indicators_CL
| where TimeGenerated >= datetime(2025-11-12 21:32:10)
| where TimeGenerated <= datetime_add('hour', 24, datetime(2025-11-12 21:32:10))
| extend HourBucket = bin(TimeGenerated, 1h)
| summarize 
    EventCount = count(),
    ByCategory = count() by category_s
    by HourBucket
| order by HourBucket asc
| project 
    Hour = HourBucket,
    Events = EventCount,
    Categories = ByCategory

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INGESTION RATE: Track polling frequency
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 11. TacitRed Ingestion Timeline (5-minute buckets)
TacitRed_Findings_CL
| where TimeGenerated >= datetime(2025-11-12 21:32:10)
| summarize EventCount = count() by bin(TimeGenerated, 5m)
| order by TimeGenerated asc
| project TimeGenerated, EventCount
| render timechart

// 12. Cyren Ingestion Timeline (5-minute buckets)
Cyren_Indicators_CL
| where TimeGenerated >= datetime(2025-11-12 21:32:10)
| summarize EventCount = count() by bin(TimeGenerated, 5m)
| order by TimeGenerated asc
| project TimeGenerated, EventCount
| render timechart

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QUICK VALIDATION CHECKLIST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âœ… STEP 1: Run queries #3 and #4 to see if NEW data is arriving
// âœ… STEP 2: Run queries #5 and #6 to compare OLD vs NEW counts
// âœ… STEP 3: Run queries #7 and #8 to monitor real-time activity
// âœ… STEP 4: Run queries #11 and #12 to visualize ingestion pattern

// â° EXPECTED TIMELINE:
// - First poll: 5-15 minutes after deployment
// - Regular polls: Every 6 hours (360 min window)
// - Data visible in portal: Within 5-10 minutes of poll completion

// ğŸ” HOW TO CONFIRM CCF IS WORKING:
// 1. Wait 15-30 minutes after deployment
// 2. Run query #3 (TacitRed NEW data)
// 3. If NewDataCount > 0, CCF is working!
// 4. Run query #4 (Cyren NEW data)
// 5. If NewDataCount > 0, CCF is working!

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
