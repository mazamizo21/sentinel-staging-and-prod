[
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2022-10-01-preview",
    "name": "TacitRedFindings",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "ThreatIntelligenceFeeds",
      "dataType": "TacitRed_Findings_CL",
      "dcrConfig": {
        "streamName": "Custom-TacitRed_Findings_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{tacitRedDcrImmutableId}}"
      },
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{tacitRedApiKey}}",
        "ApiKeyName": "Authorization"
      },
      "request": {
        "apiEndpoint": "https://app.tacitred.com/api/v1/findings",
        "httpMethod": "GET",
        "queryParameters": {
          "page_size": 100
        },
        "queryWindowInMin": 360,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "startTimeAttributeName": "from",
        "endTimeAttributeName": "until",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Microsoft-Sentinel-TacitRed/1.0"
        }
      },
      "paging": {
        "pagingType": "LinkHeader",
        "linkHeaderRelLinkName": "rel=next"
      },
      "response": {
        "eventsJsonPaths": ["$.results"]
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2022-10-01-preview",
    "name": "CyrenIPReputation",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "ThreatIntelligenceFeeds",
      "dataType": "Cyren_Indicators_CL",
      "dcrConfig": {
        "streamName": "Custom-Cyren_Indicators_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{cyrenIPDcrImmutableId}}"
      },
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{cyrenIPJwtToken}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "Bearer"
      },
      "request": {
        "apiEndpoint": "https://api-feeds.cyren.com/v1/feed/data",
        "httpMethod": "GET",
        "queryParameters": {
          "count": 100
        },
        "queryWindowInMin": 360,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "startTimeAttributeName": "start_date",
        "endTimeAttributeName": "end_date",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Microsoft-Sentinel-Cyren/1.0"
        }
      },
      "paging": {
        "pagingType": "LinkHeader",
        "linkHeaderRelLinkName": "rel=next"
      },
      "response": {
        "eventsJsonPaths": ["$"]
      }
    }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2022-10-01-preview",
    "name": "CyrenMalwareURLs",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "ThreatIntelligenceFeeds",
      "dataType": "Cyren_Indicators_CL",
      "dcrConfig": {
        "streamName": "Custom-Cyren_Indicators_CL",
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{cyrenMalwareDcrImmutableId}}"
      },
      "auth": {
        "type": "APIKey",
        "ApiKey": "{{cyrenMalwareJwtToken}}",
        "ApiKeyName": "Authorization",
        "ApiKeyIdentifier": "Bearer"
      },
      "request": {
        "apiEndpoint": "https://api-feeds.cyren.com/v1/feed/data",
        "httpMethod": "GET",
        "queryParameters": {
          "count": 100
        },
        "queryWindowInMin": 360,
        "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
        "startTimeAttributeName": "start_date",
        "endTimeAttributeName": "end_date",
        "rateLimitQps": 10,
        "retryCount": 3,
        "timeoutInSeconds": 60,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "Microsoft-Sentinel-Cyren/1.0"
        }
      },
      "paging": {
        "pagingType": "LinkHeader",
        "linkHeaderRelLinkName": "rel=next"
      },
      "response": {
        "eventsJsonPaths": ["$"]
      }
    }
  }
]
