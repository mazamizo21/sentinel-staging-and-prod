{
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "ThreatIntelligenceFeeds",
      "title": "Threat Intelligence Feeds (TacitRed + Cyren)",
      "publisher": "TacitRed & Cyren",
      "descriptionMarkdown": "Ingest threat intelligence from TacitRed (compromised credentials) and Cyren (IP reputation, malware URLs) to identify and respond to threats targeting your organization.",
      "graphQueriesTableName": "ThreatIntel_CL",
      "graphQueries": [
        {
          "metricName": "Total threat indicators received",
          "legend": "Threat Indicators",
          "baseQuery": "union TacitRed_Findings_CL, Cyren_Indicators_CL"
        }
      ],
      "sampleQueries": [
        {
          "description": "TacitRed - Compromised credentials from last 7 days",
          "query": "TacitRed_Findings_CL | where TimeGenerated >= ago(7d) | where findingType_s == 'compromised_credential' | project TimeGenerated, email_s, domain_s, confidence_d, source_s"
        },
        {
          "description": "Cyren - High-risk indicators (risk >= 70)",
          "query": "Cyren_Indicators_CL | where risk_d >= 70 | summarize count() by category_s, bin(TimeGenerated, 1h) | render timechart"
        },
        {
          "description": "Cross-feed correlation - Compromised users accessing malicious IPs",
          "query": "TacitRed_Findings_CL | join kind=inner (Cyren_Indicators_CL | where category_s == 'malware') on $left.domain_s == $right.domain_s | project TimeGenerated, email_s, domain_s, risk_d, category_s"
        }
      ],
      "dataTypes": [
        {
          "name": "TacitRed_Findings_CL",
          "lastDataReceivedQuery": "TacitRed_Findings_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
        },
        {
          "name": "Cyren_Indicators_CL",
          "lastDataReceivedQuery": "Cyren_Indicators_CL | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors",
          "value": []
        }
      ],
      "availability": {
        "status": "Available",
        "isPreview": false
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "read and write permissions are required",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "write": true,
              "read": true,
              "delete": false
            }
          },
          {
            "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
            "permissionsDisplayText": "read permissions to shared keys for the workspace are required",
            "providerDisplayName": "Keys",
            "scope": "Workspace",
            "requiredPermissions": {
              "action": true
            }
          }
        ],
        "customs": [
          {
            "name": "TacitRed API Key",
            "description": "TacitRed API key is required for authentication. Obtain from TacitRed admin console."
          },
          {
            "name": "Cyren JWT Tokens",
            "description": "Cyren JWT tokens are required for both IP Reputation and Malware URLs feeds. Obtain from Cyren portal."
          }
        ]
      },
      "instructionSteps": [
        {
          "title": "1. Configure TacitRed API Access",
          "description": "Obtain your TacitRed API key from the TacitRed admin console",
          "instructions": [
            {
              "parameters": {
                "label": "TacitRed API Key",
                "placeholder": "Enter your TacitRed API Key",
                "type": "password",
                "name": "tacitRedApiKey"
              },
              "type": "Textbox"
            }
          ]
        },
        {
          "title": "2. Configure Cyren API Access",
          "description": "Obtain your Cyren JWT tokens for IP Reputation and Malware URLs feeds",
          "instructions": [
            {
              "parameters": {
                "label": "Cyren IP Reputation JWT Token",
                "placeholder": "Enter JWT token for IP Reputation feed",
                "type": "password",
                "name": "cyrenIPJwtToken"
              },
              "type": "Textbox"
            },
            {
              "parameters": {
                "label": "Cyren Malware URLs JWT Token",
                "placeholder": "Enter JWT token for Malware URLs feed",
                "type": "password",
                "name": "cyrenMalwareJwtToken"
              },
              "type": "Textbox"
            }
          ]
        },
        {
          "title": "3. Connect to Microsoft Sentinel",
          "description": "Click the Connect button to start ingesting threat intelligence data",
          "instructions": [
            {
              "parameters": {
                "name": "connect",
                "connectLabel": "Connect",
                "disconnectLabel": "Disconnect",
                "isPrimary": true
              },
              "type": "ConnectionToggleButton"
            }
          ]
        }
      ]
    }
  }
}
