{
  "kind": "RestApiPoller",
  "properties": {
    "connectorDefinitionName": "TacitRedThreatIntel",
    "dataType": "TacitRed_Findings_CL",
    "dcrConfig": {
      "streamName": "Custom-TacitRed_Findings_Raw",
      "dataCollectionEndpoint": "https://dce-threatintel-feeds-sld7.eastus-1.ingest.monitor.azure.com",
      "dataCollectionRuleImmutableId": "dcr-92ca843929b44cb4a29ef6398c3b86d4"
    },
    "auth": {
      "type": "APIKey",
      "ApiKeyName": "Authorization",
      "ApiKey": "a2be534e-6231-4fb0-b8b8-15dbc96e83b7"
    },
    "request": {
      "apiEndpoint": "https://app.tacitred.com/api/v1/findings",
      "httpMethod": "GET",
      "queryParameters": {
        "page_size": 50
      },
      "queryWindowInMin": 600,
      "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
      "startTimeAttributeName": "from",
      "endTimeAttributeName": "until",
      "rateLimitQps": 10,
      "retryCount": 3,
      "timeoutInSeconds": 60,
      "headers": {
        "Accept": "application/json",
        "User-Agent": "Microsoft-Sentinel-TacitRed/1.0"
      }
    },
    "paging": {
      "pagingType": "LinkHeader",
      "linkHeaderTokenJsonPath": "$.next"
    },
    "response": {
      "eventsJsonPaths": ["$.results"],
      "format": "json"
    }
  }
}
